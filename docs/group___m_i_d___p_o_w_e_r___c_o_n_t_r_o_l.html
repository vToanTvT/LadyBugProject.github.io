<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LadyBug Firmware Documentation: Power Control Middleware</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LadyBug Firmware Documentation<span id="projectnumber">&#160;v2.1</span>
   </div>
   <div id="projectbrief">Update data according main board hardware ver2.1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Power Control Middleware <div class="ingroups"><a class="el" href="group___m_i_d_d_l_e_w_a_r_e___l_a_y_e_r.html">Middleware Layer</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Power derating and thermal management.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Power Control Middleware:</div>
<div class="dyncontent">
<div class="center"><img src="group___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l.png" border="0" usemap="#agroup______m__i__d______p__o__w__e__r______c__o__n__t__r__o__l" loading="lazy" alt=""/></div>
<map name="agroup______m__i__d______p__o__w__e__r______c__o__n__t__r__o__l" id="agroup______m__i__d______p__o__w__e__r______c__o__n__t__r__o__l">
<area shape="rect" href="group___m_i_d_d_l_e_w_a_r_e___l_a_y_e_r.html" title="Control logic and system services." alt="" coords="5,5,129,32"/>
<area shape="rect" title="Power derating and thermal management." alt="" coords="177,5,351,32"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:S_5FPowerCtrl_5Ft" id="r_S_5FPowerCtrl_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public macro definitions.  <a href="struct_s___power_ctrl__t.html#details">More...</a><br /></td></tr>
<tr class="memitem:S_5FDeratePoint_5Ft" id="r_S_5FDeratePoint_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s___derate_point__t.html">S_DeratePoint_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single derating point with hysteresis thresholds.  <a href="struct_s___derate_point__t.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gae4279df7c104359ca34146a90ba5b593" id="r_gae4279df7c104359ca34146a90ba5b593"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae4279df7c104359ca34146a90ba5b593">PWRCTRL_UPDATE_PERIOD_TICKS</a>&#160;&#160;&#160;10000U</td></tr>
<tr class="memdesc:gae4279df7c104359ca34146a90ba5b593"><td class="mdescLeft">&#160;</td><td class="mdescRight">Include required header files.  <br /></td></tr>
<tr class="memitem:ga280ddd23f3dcdd7d9cdd6459fea5d567" id="r_ga280ddd23f3dcdd7d9cdd6459fea5d567"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga280ddd23f3dcdd7d9cdd6459fea5d567">PWRCTRL_PERIOD</a>&#160;&#160;&#160;500U</td></tr>
<tr class="memitem:gaf2cf2b96a61c74a3131e1f528588b262" id="r_gaf2cf2b96a61c74a3131e1f528588b262"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf2cf2b96a61c74a3131e1f528588b262">PWRCTRL_DEFAULT_VOLTAGE_COEF</a>&#160;&#160;&#160;1.0f</td></tr>
<tr class="memitem:ga7d826550664c48ca29d451b35496c421" id="r_ga7d826550664c48ca29d451b35496c421"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7d826550664c48ca29d451b35496c421">PWRCTRL_DEFAULT_TEMP_COEF</a>&#160;&#160;&#160;1.0f</td></tr>
<tr class="memitem:ga67cecbdb6ea48fe0db2f4ceab25a8f91" id="r_ga67cecbdb6ea48fe0db2f4ceab25a8f91"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga67cecbdb6ea48fe0db2f4ceab25a8f91">NORMAL_TEMPERATURE</a>&#160;&#160;&#160;25.0f</td></tr>
<tr class="memitem:ga43a5156a6b1138c20fab6ca2db8330e2" id="r_ga43a5156a6b1138c20fab6ca2db8330e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga43a5156a6b1138c20fab6ca2db8330e2">NORMAL_AC_VOLTAGE</a>&#160;&#160;&#160;150.0f</td></tr>
<tr class="memitem:gaeeea42d55f471c08d7621ca4b7c6639a" id="r_gaeeea42d55f471c08d7621ca4b7c6639a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaeeea42d55f471c08d7621ca4b7c6639a">TEMP_CNT</a>&#160;&#160;&#160;5U</td></tr>
<tr class="memitem:ga93402300bb576b937a3e5790b57bd87d" id="r_ga93402300bb576b937a3e5790b57bd87d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga93402300bb576b937a3e5790b57bd87d">ACVOL_CNT</a>&#160;&#160;&#160;5U</td></tr>
<tr class="memitem:gaa6e76f4521435290179bf24f98731b50" id="r_gaa6e76f4521435290179bf24f98731b50"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa6e76f4521435290179bf24f98731b50">POWER_MAX</a>&#160;&#160;&#160;840.0f</td></tr>
<tr class="memitem:gae75b3ef9a66ce9aa2c978b4691e8c62a" id="r_gae75b3ef9a66ce9aa2c978b4691e8c62a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae75b3ef9a66ce9aa2c978b4691e8c62a">POWER_SOFT_LIMIT</a>&#160;&#160;&#160;(<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#gacd52246a8e750f96fd70de622a034669">BAT_CURRENT_HIGH_LIMIT_SOFT</a>*<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga097bac9a5eb4dea8f5b0807cc52a3b68">BAT_VOLTAGE_HIGH_LIMIT_SOFT</a>)</td></tr>
<tr class="memitem:ga6210f012d857d1901f8306a1f845b34a" id="r_ga6210f012d857d1901f8306a1f845b34a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6210f012d857d1901f8306a1f845b34a">DERATE_POWER_HYSTERESIS_WATT</a>&#160;&#160;&#160;20.0f</td></tr>
<tr class="memitem:gaf0ad7223d375d9d20e091953104ff312" id="r_gaf0ad7223d375d9d20e091953104ff312"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf0ad7223d375d9d20e091953104ff312">PFC_VOL_START_DERATE</a>&#160;&#160;&#160;110.0f</td></tr>
<tr class="memitem:gab9bbd53e0bef89477efc991b6a3293d6" id="r_gab9bbd53e0bef89477efc991b6a3293d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab9bbd53e0bef89477efc991b6a3293d6">PWRCTRL_INPUT_VOLT_DERATE_Q15</a>&#160;&#160;&#160;(<a class="el" href="#gaf0ad7223d375d9d20e091953104ff312">PFC_VOL_START_DERATE</a> - <a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga23ee6771cd927869c262321ac1ee7cfc">AC_VOLTAGE_OFFSET_F32</a>)/(2*<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga5ff403a86b1b6f0d079b926c3cd6a17d">AC_VOLTAGE_GAIN_F32</a>)</td></tr>
<tr class="memitem:gaa089e5d482702eba08533250dc88c053" id="r_gaa089e5d482702eba08533250dc88c053"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa089e5d482702eba08533250dc88c053">POWER_MAX_Q15</a>&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(<a class="el" href="#gaa6e76f4521435290179bf24f98731b50">POWER_MAX</a>/<a class="el" href="#gae75b3ef9a66ce9aa2c978b4691e8c62a">POWER_SOFT_LIMIT</a>)</td></tr>
<tr class="memitem:gab32d9f33d1b75c493afbcdb534f1e965" id="r_gab32d9f33d1b75c493afbcdb534f1e965"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab32d9f33d1b75c493afbcdb534f1e965">DERATE_POWER_HYSTERESIS_Q15</a>&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(<a class="el" href="#ga6210f012d857d1901f8306a1f845b34a">DERATE_POWER_HYSTERESIS_WATT</a> / <a class="el" href="#gae75b3ef9a66ce9aa2c978b4691e8c62a">POWER_SOFT_LIMIT</a>)</td></tr>
<tr class="memitem:ga993672753ece91c8ef65baf5a27dc644" id="r_ga993672753ece91c8ef65baf5a27dc644"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga993672753ece91c8ef65baf5a27dc644">PWRCTRL_DEFAULT_VOLTAGE_COEF_Q15</a>&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(<a class="el" href="#gaf2cf2b96a61c74a3131e1f528588b262">PWRCTRL_DEFAULT_VOLTAGE_COEF</a>)</td></tr>
<tr class="memitem:ga67cc7b70b27cecfbf0c49daf17267f29" id="r_ga67cc7b70b27cecfbf0c49daf17267f29"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga67cc7b70b27cecfbf0c49daf17267f29">PWRCTRL_DEFAULT_TEMP_COEF_Q15</a>&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(<a class="el" href="#ga7d826550664c48ca29d451b35496c421">PWRCTRL_DEFAULT_TEMP_COEF</a>)</td></tr>
<tr class="memitem:ga9d7589e890b12ba88aab9bd99fcca947" id="r_ga9d7589e890b12ba88aab9bd99fcca947"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9d7589e890b12ba88aab9bd99fcca947">PWRCTRL_DERATE_COEF_INIT</a>&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(1.0f)</td></tr>
<tr class="memitem:ga89025cadcba0c515fe5e186ad2e75cb1" id="r_ga89025cadcba0c515fe5e186ad2e75cb1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga89025cadcba0c515fe5e186ad2e75cb1">NORMAL_TEMPERATURE_Q15</a>&#160;&#160;&#160;<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga2c0cfc2e52acc6199524d5517e3ca022">THERMAL_FLOAT_TO_Q15</a>(<a class="el" href="#ga67cecbdb6ea48fe0db2f4ceab25a8f91">NORMAL_TEMPERATURE</a>)</td></tr>
<tr class="memitem:gadba3c0f2062afccca29d3508d9e82ac4" id="r_gadba3c0f2062afccca29d3508d9e82ac4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gadba3c0f2062afccca29d3508d9e82ac4">NORMAL_AC_VOLTAGE_Q15</a>&#160;&#160;&#160;<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga44e359e7ebada8996e9a4e000a118f6a">VAC_FLOAT_TO_Q15</a>(<a class="el" href="#ga43a5156a6b1138c20fab6ca2db8330e2">NORMAL_AC_VOLTAGE</a>)</td></tr>
<tr class="memitem:ga59e3100b2a9c776f8aa01ab52db9be19" id="r_ga59e3100b2a9c776f8aa01ab52db9be19"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga59e3100b2a9c776f8aa01ab52db9be19">PWRCTRL_DERATE_CONDITION</a>&#160;&#160;&#160;(ac_voltage_inst.value_q15 &gt; <a class="el" href="#gab9bbd53e0bef89477efc991b6a3293d6">PWRCTRL_INPUT_VOLT_DERATE_Q15</a>)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3ea28682838bb6082b26dbaf4b46d561" id="r_ga3ea28682838bb6082b26dbaf4b46d561"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3ea28682838bb6082b26dbaf4b46d561">pwrctrl_init_</a> (<a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a> *pPowerControl)</td></tr>
<tr class="memdesc:ga3ea28682838bb6082b26dbaf4b46d561"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global function prototypes.  <br /></td></tr>
<tr class="memitem:gab5eae99e7c2070562bb5e7fad83388c5" id="r_gab5eae99e7c2070562bb5e7fad83388c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab5eae99e7c2070562bb5e7fad83388c5">pwrctrl_tick_</a> (<a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a> *pPowerControl)</td></tr>
<tr class="memdesc:gab5eae99e7c2070562bb5e7fad83388c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tick handler for periodic update control.  <br /></td></tr>
<tr class="memitem:ga0d28bfa2310fbd7c34ce2ed130bc3356" id="r_ga0d28bfa2310fbd7c34ce2ed130bc3356"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0d28bfa2310fbd7c34ce2ed130bc3356">pwrctrl_update_coef_</a> (<a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a> *pPowerControl)</td></tr>
<tr class="memdesc:ga0d28bfa2310fbd7c34ce2ed130bc3356"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update derating coefficients and power calculations.  <br /></td></tr>
<tr class="memitem:ga4967a767bd354d2ce90133a5379de3e4" id="r_ga4967a767bd354d2ce90133a5379de3e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4967a767bd354d2ce90133a5379de3e4">pwrctrl_process_update_</a> (<a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a> *pPowerControl)</td></tr>
<tr class="memdesc:ga4967a767bd354d2ce90133a5379de3e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process periodic update when flag is set.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gae85bfdc96f8f99d18559d2bb55a7991b" id="r_gae85bfdc96f8f99d18559d2bb55a7991b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae85bfdc96f8f99d18559d2bb55a7991b">g_pwrctrl_inst</a></td></tr>
<tr class="memdesc:gae85bfdc96f8f99d18559d2bb55a7991b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global variable declarations.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<p>Power derating and thermal management. </p>
<p>This module implements intelligent power derating based on:</p><ul>
<li>Temperature monitoring (PFC and LLC thermal sensors)</li>
<li>AC input voltage monitoring</li>
<li>Multi-zone derating tables with hysteresis</li>
<li>Moving average and median filtering for stable decisions</li>
<li>Configurable derating curves (4 zones each)</li>
<li>Power output calculation and limiting</li>
<li>Periodic update mechanism (1s interval)</li>
<li>Q15 fixed-point arithmetic for efficient embedded execution</li>
</ul>
<dl class="section version"><dt>Version</dt><dd>1.0.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>August 9, 2025 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>EVSELab Co. Jsc. </dd></dl>
<a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="ga93402300bb576b937a3e5790b57bd87d" name="ga93402300bb576b937a3e5790b57bd87d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga93402300bb576b937a3e5790b57bd87d">&#9670;&#160;</a></span>ACVOL_CNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ACVOL_CNT&#160;&#160;&#160;5U</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>AC voltage buffer size for averaging </p>

</div>
</div>
<a id="gab32d9f33d1b75c493afbcdb534f1e965" name="gab32d9f33d1b75c493afbcdb534f1e965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab32d9f33d1b75c493afbcdb534f1e965">&#9670;&#160;</a></span>DERATE_POWER_HYSTERESIS_Q15</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DERATE_POWER_HYSTERESIS_Q15&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(<a class="el" href="#ga6210f012d857d1901f8306a1f845b34a">DERATE_POWER_HYSTERESIS_WATT</a> / <a class="el" href="#gae75b3ef9a66ce9aa2c978b4691e8c62a">POWER_SOFT_LIMIT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Power hysteresis in Q15 </p>

</div>
</div>
<a id="ga6210f012d857d1901f8306a1f845b34a" name="ga6210f012d857d1901f8306a1f845b34a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6210f012d857d1901f8306a1f845b34a">&#9670;&#160;</a></span>DERATE_POWER_HYSTERESIS_WATT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DERATE_POWER_HYSTERESIS_WATT&#160;&#160;&#160;20.0f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Power hysteresis for mode switching (W) </p>

</div>
</div>
<a id="ga43a5156a6b1138c20fab6ca2db8330e2" name="ga43a5156a6b1138c20fab6ca2db8330e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga43a5156a6b1138c20fab6ca2db8330e2">&#9670;&#160;</a></span>NORMAL_AC_VOLTAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NORMAL_AC_VOLTAGE&#160;&#160;&#160;150.0f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Normal AC voltage (V) </p>

</div>
</div>
<a id="gadba3c0f2062afccca29d3508d9e82ac4" name="gadba3c0f2062afccca29d3508d9e82ac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadba3c0f2062afccca29d3508d9e82ac4">&#9670;&#160;</a></span>NORMAL_AC_VOLTAGE_Q15</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NORMAL_AC_VOLTAGE_Q15&#160;&#160;&#160;<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga44e359e7ebada8996e9a4e000a118f6a">VAC_FLOAT_TO_Q15</a>(<a class="el" href="#ga43a5156a6b1138c20fab6ca2db8330e2">NORMAL_AC_VOLTAGE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Normal AC voltage in Q15 </p>

</div>
</div>
<a id="ga67cecbdb6ea48fe0db2f4ceab25a8f91" name="ga67cecbdb6ea48fe0db2f4ceab25a8f91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga67cecbdb6ea48fe0db2f4ceab25a8f91">&#9670;&#160;</a></span>NORMAL_TEMPERATURE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NORMAL_TEMPERATURE&#160;&#160;&#160;25.0f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Normal operating temperature (°C) </p>

</div>
</div>
<a id="ga89025cadcba0c515fe5e186ad2e75cb1" name="ga89025cadcba0c515fe5e186ad2e75cb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89025cadcba0c515fe5e186ad2e75cb1">&#9670;&#160;</a></span>NORMAL_TEMPERATURE_Q15</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NORMAL_TEMPERATURE_Q15&#160;&#160;&#160;<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga2c0cfc2e52acc6199524d5517e3ca022">THERMAL_FLOAT_TO_Q15</a>(<a class="el" href="#ga67cecbdb6ea48fe0db2f4ceab25a8f91">NORMAL_TEMPERATURE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Normal temperature in Q15 </p>

</div>
</div>
<a id="gaf0ad7223d375d9d20e091953104ff312" name="gaf0ad7223d375d9d20e091953104ff312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf0ad7223d375d9d20e091953104ff312">&#9670;&#160;</a></span>PFC_VOL_START_DERATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PFC_VOL_START_DERATE&#160;&#160;&#160;110.0f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>PFC voltage threshold to start derating (V) </p>

</div>
</div>
<a id="gaa6e76f4521435290179bf24f98731b50" name="gaa6e76f4521435290179bf24f98731b50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa6e76f4521435290179bf24f98731b50">&#9670;&#160;</a></span>POWER_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POWER_MAX&#160;&#160;&#160;840.0f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum power output (W) </p>

</div>
</div>
<a id="gaa089e5d482702eba08533250dc88c053" name="gaa089e5d482702eba08533250dc88c053"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa089e5d482702eba08533250dc88c053">&#9670;&#160;</a></span>POWER_MAX_Q15</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POWER_MAX_Q15&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(<a class="el" href="#gaa6e76f4521435290179bf24f98731b50">POWER_MAX</a>/<a class="el" href="#gae75b3ef9a66ce9aa2c978b4691e8c62a">POWER_SOFT_LIMIT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Max power in Q15 </p>

</div>
</div>
<a id="gae75b3ef9a66ce9aa2c978b4691e8c62a" name="gae75b3ef9a66ce9aa2c978b4691e8c62a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae75b3ef9a66ce9aa2c978b4691e8c62a">&#9670;&#160;</a></span>POWER_SOFT_LIMIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POWER_SOFT_LIMIT&#160;&#160;&#160;(<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#gacd52246a8e750f96fd70de622a034669">BAT_CURRENT_HIGH_LIMIT_SOFT</a>*<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga097bac9a5eb4dea8f5b0807cc52a3b68">BAT_VOLTAGE_HIGH_LIMIT_SOFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Software power limit (W) </p>

</div>
</div>
<a id="ga7d826550664c48ca29d451b35496c421" name="ga7d826550664c48ca29d451b35496c421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7d826550664c48ca29d451b35496c421">&#9670;&#160;</a></span>PWRCTRL_DEFAULT_TEMP_COEF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PWRCTRL_DEFAULT_TEMP_COEF&#160;&#160;&#160;1.0f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default temperature derating coefficient </p>

</div>
</div>
<a id="ga67cc7b70b27cecfbf0c49daf17267f29" name="ga67cc7b70b27cecfbf0c49daf17267f29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga67cc7b70b27cecfbf0c49daf17267f29">&#9670;&#160;</a></span>PWRCTRL_DEFAULT_TEMP_COEF_Q15</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PWRCTRL_DEFAULT_TEMP_COEF_Q15&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(<a class="el" href="#ga7d826550664c48ca29d451b35496c421">PWRCTRL_DEFAULT_TEMP_COEF</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default temp coef in Q15 </p>

</div>
</div>
<a id="gaf2cf2b96a61c74a3131e1f528588b262" name="gaf2cf2b96a61c74a3131e1f528588b262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf2cf2b96a61c74a3131e1f528588b262">&#9670;&#160;</a></span>PWRCTRL_DEFAULT_VOLTAGE_COEF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PWRCTRL_DEFAULT_VOLTAGE_COEF&#160;&#160;&#160;1.0f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default voltage derating coefficient </p>

</div>
</div>
<a id="ga993672753ece91c8ef65baf5a27dc644" name="ga993672753ece91c8ef65baf5a27dc644"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga993672753ece91c8ef65baf5a27dc644">&#9670;&#160;</a></span>PWRCTRL_DEFAULT_VOLTAGE_COEF_Q15</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PWRCTRL_DEFAULT_VOLTAGE_COEF_Q15&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(<a class="el" href="#gaf2cf2b96a61c74a3131e1f528588b262">PWRCTRL_DEFAULT_VOLTAGE_COEF</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default voltage coef in Q15 </p>

</div>
</div>
<a id="ga9d7589e890b12ba88aab9bd99fcca947" name="ga9d7589e890b12ba88aab9bd99fcca947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9d7589e890b12ba88aab9bd99fcca947">&#9670;&#160;</a></span>PWRCTRL_DERATE_COEF_INIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PWRCTRL_DERATE_COEF_INIT&#160;&#160;&#160;<a class="el" href="group___m_i_d___i_q_m_a_t_h.html#gac863d74a9c184d73cd19f50725219974">_q15</a>(1.0f)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initial derate coefficient (Q15) </p>

</div>
</div>
<a id="ga59e3100b2a9c776f8aa01ab52db9be19" name="ga59e3100b2a9c776f8aa01ab52db9be19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga59e3100b2a9c776f8aa01ab52db9be19">&#9670;&#160;</a></span>PWRCTRL_DERATE_CONDITION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PWRCTRL_DERATE_CONDITION&#160;&#160;&#160;(ac_voltage_inst.value_q15 &gt; <a class="el" href="#gab9bbd53e0bef89477efc991b6a3293d6">PWRCTRL_INPUT_VOLT_DERATE_Q15</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro to check derate condition </p>

</div>
</div>
<a id="gab9bbd53e0bef89477efc991b6a3293d6" name="gab9bbd53e0bef89477efc991b6a3293d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab9bbd53e0bef89477efc991b6a3293d6">&#9670;&#160;</a></span>PWRCTRL_INPUT_VOLT_DERATE_Q15</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PWRCTRL_INPUT_VOLT_DERATE_Q15&#160;&#160;&#160;(<a class="el" href="#gaf0ad7223d375d9d20e091953104ff312">PFC_VOL_START_DERATE</a> - <a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga23ee6771cd927869c262321ac1ee7cfc">AC_VOLTAGE_OFFSET_F32</a>)/(2*<a class="el" href="group___m_i_d___m_e_a_s_u_r_e_m_e_n_t.html#ga5ff403a86b1b6f0d079b926c3cd6a17d">AC_VOLTAGE_GAIN_F32</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Input voltage derate threshold (Q15) </p>

</div>
</div>
<a id="ga280ddd23f3dcdd7d9cdd6459fea5d567" name="ga280ddd23f3dcdd7d9cdd6459fea5d567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga280ddd23f3dcdd7d9cdd6459fea5d567">&#9670;&#160;</a></span>PWRCTRL_PERIOD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PWRCTRL_PERIOD&#160;&#160;&#160;500U</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Power control period (500 ms) </p>

</div>
</div>
<a id="gae4279df7c104359ca34146a90ba5b593" name="gae4279df7c104359ca34146a90ba5b593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4279df7c104359ca34146a90ba5b593">&#9670;&#160;</a></span>PWRCTRL_UPDATE_PERIOD_TICKS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PWRCTRL_UPDATE_PERIOD_TICKS&#160;&#160;&#160;10000U</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Include required header files. </p>
<p>Public constant definitions. </p><dl class="section note"><dt>Note</dt><dd>Power control parameters and thresholds. Power control update period (1s @ 10kHz) </dd></dl>

</div>
</div>
<a id="gaeeea42d55f471c08d7621ca4b7c6639a" name="gaeeea42d55f471c08d7621ca4b7c6639a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeeea42d55f471c08d7621ca4b7c6639a">&#9670;&#160;</a></span>TEMP_CNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEMP_CNT&#160;&#160;&#160;5U</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Temperature buffer size for averaging </p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga3ea28682838bb6082b26dbaf4b46d561" name="ga3ea28682838bb6082b26dbaf4b46d561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ea28682838bb6082b26dbaf4b46d561">&#9670;&#160;</a></span>pwrctrl_init_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pwrctrl_init_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a> *</td>          <td class="paramname"><span class="paramname"><em>pPowerControl</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global function prototypes. </p>
<p>Initialize power control module.</p>
<p>Sets default coefficients, clears buffers, initializes zone indices. Should be called once at system startup before any update operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pPowerControl</td><td>Pointer to power control instance structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Initializes to normal conditions (25°C, 150V AC, coef=1.0). </dd>
<dd>
Sets zone indices to -1 for first lookup initialization. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga3ea28682838bb6082b26dbaf4b46d561_icgraph.png" border="0" usemap="#agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga3ea28682838bb6082b26dbaf4b46d561_icgraph" loading="lazy" alt=""/></div>
<map name="agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga3ea28682838bb6082b26dbaf4b46d561_icgraph" id="agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga3ea28682838bb6082b26dbaf4b46d561_icgraph">
<area shape="rect" title="Global function prototypes." alt="" coords="313,5,404,32"/>
<area shape="rect" href="group___a_p_p___l_a_d_y_b_u_g.html#ga92575d106e9621cd83364e7921c16842" title="Global function implementations." alt="" coords="103,5,265,32"/>
<area shape="poly" title=" " alt="" coords="297,21,265,21,265,16,297,16"/>
<area shape="rect" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The application entry point." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ga4967a767bd354d2ce90133a5379de3e4" name="ga4967a767bd354d2ce90133a5379de3e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4967a767bd354d2ce90133a5379de3e4">&#9670;&#160;</a></span>pwrctrl_process_update_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pwrctrl_process_update_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a> *</td>          <td class="paramname"><span class="paramname"><em>pPowerControl</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process periodic update when flag is set. </p>
<p>Checks update flag and calls <a class="el" href="#ga0d28bfa2310fbd7c34ce2ed130bc3356" title="Update derating coefficients and power calculations.">pwrctrl_update_coef_()</a> if set. Typically called in main loop after <a class="el" href="#gab5eae99e7c2070562bb5e7fad83388c5" title="Tick handler for periodic update control.">pwrctrl_tick_()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pPowerControl</td><td>Pointer to power control instance structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Automatically clears update flag after processing. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga4967a767bd354d2ce90133a5379de3e4_cgraph.png" border="0" usemap="#agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga4967a767bd354d2ce90133a5379de3e4_cgraph" loading="lazy" alt=""/></div>
<map name="agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga4967a767bd354d2ce90133a5379de3e4_cgraph" id="agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga4967a767bd354d2ce90133a5379de3e4_cgraph">
<area shape="rect" title="Process periodic update when flag is set." alt="" coords="5,5,172,32"/>
<area shape="rect" href="group___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l.html#ga0d28bfa2310fbd7c34ce2ed130bc3356" title="Update derating coefficients and power calculations." alt="" coords="220,5,365,32"/>
<area shape="poly" title=" " alt="" coords="172,16,204,16,204,21,172,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga4967a767bd354d2ce90133a5379de3e4_icgraph.png" border="0" usemap="#agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga4967a767bd354d2ce90133a5379de3e4_icgraph" loading="lazy" alt=""/></div>
<map name="agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga4967a767bd354d2ce90133a5379de3e4_icgraph" id="agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga4967a767bd354d2ce90133a5379de3e4_icgraph">
<area shape="rect" title="Process periodic update when flag is set." alt="" coords="290,5,456,32"/>
<area shape="rect" href="group___a_p_p___l_a_d_y_b_u_g.html#gaa975937fac78c9e28b50ff05c8325e2f" title="Infinite loop processing for background tasks." alt="" coords="103,5,242,32"/>
<area shape="poly" title=" " alt="" coords="274,21,242,21,242,16,274,16"/>
<area shape="rect" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The application entry point." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="gab5eae99e7c2070562bb5e7fad83388c5" name="gab5eae99e7c2070562bb5e7fad83388c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab5eae99e7c2070562bb5e7fad83388c5">&#9670;&#160;</a></span>pwrctrl_tick_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pwrctrl_tick_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a> *</td>          <td class="paramname"><span class="paramname"><em>pPowerControl</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tick handler for periodic update control. </p>
<p>Increments counter and sets update flag when period expires. Call this function at fixed rate (e.g., 10kHz main loop).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pPowerControl</td><td>Pointer to power control instance structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Default period is 1s (10000 ticks @ 10kHz). </dd></dl>

</div>
</div>
<a id="ga0d28bfa2310fbd7c34ce2ed130bc3356" name="ga0d28bfa2310fbd7c34ce2ed130bc3356"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0d28bfa2310fbd7c34ce2ed130bc3356">&#9670;&#160;</a></span>pwrctrl_update_coef_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pwrctrl_update_coef_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a> *</td>          <td class="paramname"><span class="paramname"><em>pPowerControl</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update derating coefficients and power calculations. </p>
<p>Computes temperature and voltage coefficients from buffered measurements, calculates overall derating (minimum of both), updates power limits, and manages derate mode with hysteresis.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pPowerControl</td><td>Pointer to power control instance structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Uses hysteresis (±20W) to prevent mode oscillation. </dd>
<dd>
Voltage derating currently disabled (commented out). </dd>
<dd>
Call this after measurements are updated. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga0d28bfa2310fbd7c34ce2ed130bc3356_icgraph.png" border="0" usemap="#agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga0d28bfa2310fbd7c34ce2ed130bc3356_icgraph" loading="lazy" alt=""/></div>
<map name="agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga0d28bfa2310fbd7c34ce2ed130bc3356_icgraph" id="agroup___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l_ga0d28bfa2310fbd7c34ce2ed130bc3356_icgraph">
<area shape="rect" title="Update derating coefficients and power calculations." alt="" coords="504,5,650,32"/>
<area shape="rect" href="group___m_i_d___p_o_w_e_r___c_o_n_t_r_o_l.html#ga4967a767bd354d2ce90133a5379de3e4" title="Process periodic update when flag is set." alt="" coords="290,5,456,32"/>
<area shape="poly" title=" " alt="" coords="489,21,457,21,457,16,489,16"/>
<area shape="rect" href="group___a_p_p___l_a_d_y_b_u_g.html#gaa975937fac78c9e28b50ff05c8325e2f" title="Infinite loop processing for background tasks." alt="" coords="103,5,242,32"/>
<area shape="poly" title=" " alt="" coords="274,21,242,21,242,16,274,16"/>
<area shape="rect" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The application entry point." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="gae85bfdc96f8f99d18559d2bb55a7991b" name="gae85bfdc96f8f99d18559d2bb55a7991b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae85bfdc96f8f99d18559d2bb55a7991b">&#9670;&#160;</a></span>g_pwrctrl_inst</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_s___power_ctrl__t.html">S_PowerCtrl_t</a> g_pwrctrl_inst</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Global variable declarations. </p>
<p>Global power control instance</p>
<p>Global variable declarations.</p>
<p>Global power control instance </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
